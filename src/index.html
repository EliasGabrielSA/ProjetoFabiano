<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <title>Estoque</title>
  <!-- Favicon-->
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
  <!-- Bootstrap icons-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
  <!-- Core theme CSS (includes Bootstrap)-->
  <link href="css/styles.css" rel="stylesheet" />
  <link rel="stylesheet" href="./css/produtos.css">
</head>

<body>
  <!-- Header-->
  <header class="bg-dark py-2">
    <div class="container ">
      <div class="text-center text-white">
        <h1>Estoque</h1>
      </div>
    </div>
  </header>
  <div class="m-2">
    <button type="button" class="btn btn-primary" data-bs-toggle="modal"
      data-bs-target="#frmCadastroProduto">Incluir</button>

  </div>
  <!-- Section-->
  <section class="m-2">
    <table class="table">
      <thead>
        <tr>
          <th scope="col">Código</th>
          <th scope="col">Descrição</th>
          <th scope="col">Data de Validade</th>
          <th scope="col">Ações</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </section>
  <!-- Footer-->
  <footer class="py-5 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white">Copyright &copy; IIF Website 2023</p>
    </div>
  </footer>
  <!-- Modal produtos -->
  <div class="modal fade" id="frmCadastroProduto" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">Cadastro de produtos</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form action="http://localhost:3000/produtos" id="frmProd" method="post">
            <div>
              <label for="">Descrição</label>
              <input type="text" class="form-control" id="inpDescricao" name="descricao" required>
            </div>
            <div class="row">
              <div class="col-3">
                <label for="">Data de Validade</label>
                <input type="date" class="form-control" id="inpDt_validade" name="dt_validade">
              </div>
            </div>
            <div class="mt-2">
              <button type="submit" id="btnProdutoInc" class="btn btn-primary">Confirmar</button>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="frmExcluirProduto" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">Deseja excluir o produto?</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <button class="btn btn-danger" id="btnExcluirModal">Sim</button>
          <button class="btn btn-info" data-bs-dismiss="modal">Não</button>

        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap core JS-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
  <!-- Core theme JS-->
  <script src="js/produtos.js" type="module"></script>
  <script src="Back\index.js"></script>

  <script>
    fetch('http://localhost:3000/produtos')
      .then(response => response.json())
      .then(data => {
        // Get a reference to the table body
        const tbody = document.querySelector('table tbody');

        // Remove any existing rows in the table body
        while (tbody.firstChild) {
          tbody.firstChild.remove();
        }

        // Loop through the data and add a row for each item
        data.forEach(item => {
          const row = document.createElement('tr');

          const codigoCell = document.createElement('td');
          codigoCell.textContent = item.codigo;
          row.appendChild(codigoCell);

          const descricaoCell = document.createElement('td');
          descricaoCell.textContent = item.descricao;
          row.appendChild(descricaoCell);

          const validadeCell = document.createElement('td');
          validadeCell.textContent = item.dt_validade;
          row.appendChild(validadeCell);

          const actionsCell = document.createElement('td');
          actionsCell.innerHTML = '<button class="btn btn-primary">Edit</button> <button class="btn btn-danger">Delete</button>';
          row.appendChild(actionsCell);

          tbody.appendChild(row);
        });
      })
      .catch(error => {
        console.error('Error:', error);
      });
  </script>
</body>

</html>